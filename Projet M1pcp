#Pandas with Zerg Nassima,Otmani Nardjes, Saim mamoune Nadia, Benarbia Sara, Merdji Narimane, Chikh Rania Ibtissem.py        
#for Master1PCP Tlemcen...Date=13/12/2025

import pandas as pd

# 1) Créer et afficher le tableau
data = {
    "Séquence": ["ATGCGTACGTA", "GCTAGCTAGGCC", "ATGCGCGTAAGT", "TACGATCGTA", "ATGAAGGGCTT", "CGTACGTAGC", "TTACCCGGAT"]
    "Longueur": [12, 12, 12, 10, 11, 10, 10],
    "pourcentage GC": [50, 66.67, 58.33, 40, 45.45, 60, 50]
}

df = pd.DataFrame(data)
print("1) Tableau complet :")
print(df)
print("\n")

# 2) Sélectionner et afficher uniquement la colonne "Longueur"
print("2) Colonne 'Longueur' :")
print(df["Longueur"])
print("\n")

# 3) filtrer les séquences dont la longueur est séperieure à 10 
longueur_superieur_10 = df[df["Longueur"] > 10] 
print("3)séquences avec longueur > 10:")
print(longueur_superieur_10)
print("\n")

# 4) Calculer le pourcentage moyen de GC avec 3 chiffres après la virgule
moyenne_gc = round(df["Pourcentage GC"].mean(), 3)
print(f"4) Pourcentage moyen de GC : {moyenne_gc}%")
print("\n")

# 5) Ajouter une colonne "Catégorie GC"
def categoriser_gc(pourcentage):
    if pourcentage > 55:
        return "Riche"
    elif pourcentage >= 45:
        return "Moyen"
    else:
        return "Faible"

df["Catégorie GC"] = df["Pourcentage GC"].apply(categoriser_gc)
print("5) Tableau avec catégorie GC :")
print(df)
print("\n")

# 6) Ajouter une colonne donnant le nombre de 'G' dans chaque séquence
def compter_G(sequence):
    return sequence.count('G')

df["Nombre de G"] = df["Séquence"].apply(compter_G)
print("6) Tableau avec nombre de G :")
print(df)

# 7) Calculer l'écart-type du %GC et de la longueur des séquences
ecart_type_gc = round(df["Pourcentage GC"].std(), 4)
ecart_type_longueur = round(df["Longueur"].std(), 4)

print(f"7) Écart-type du %GC : {ecart_type_gc}")
print(f"   Écart-type de la longueur : {ecart_type_longueur}")
print("\n")

# 8) Sauvegarder le tableau final dans un fichier CSV
df.to_csv("sequences_adn_analyse.csv", index=False, encoding='utf-8')
print("8) Tableau sauvegardé dans 'sequences_adn_analyse.csv'")
print("\nTableau final :")
print(df)
